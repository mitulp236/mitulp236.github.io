<!DOCTYPE html><html lang="en"><head><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" content="#000000"/><link rel="alternate" type="application/rss+xml" href="/index.xml"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&amp;display=swap"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&amp;display=swap" media="print"/><noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&amp;display=swap"/></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css" integrity="sha384-t5CR+zwDAROtph0PXGte6ia8heboACF9R5l/DiY+WZ3P2lxNgvJkQk5n7GPvLMYw" crossorigin="anonymous"/><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if("system"===e||(!e&&true)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://twitter.com/mitulp236"/><meta name="twitter:creator" content="https://twitter.com/mitulp236"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="600"/><meta property="og:locale" content="en-us"/><meta name="author" content="Mitul Patel"/><title>Problems with PubNub: A Deep Dive into Chat System Challenges – Mitul Patel</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="In our client&#x27;s project, we were tasked with developing a comprehensive chat module. The requirements included functionalities such as one-to-one, group, and community chat, where all users could participate without strict limitations on joining specific chat channels."/><meta property="og:url" content="https://tailwind-nextjs-starter-blog.vercel.app/blog/problems-with-pubnub"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2024-02-25T00:00:00.000Z"/><meta property="article:modified_time" content="2024-02-25T00:00:00.000Z"/><meta property="article:author" content="https://tailwind-nextjs-starter-blog.vercel.app/about"/><meta property="article:tag" content="Tech"/><meta property="article:tag" content="PubNub"/><meta property="article:tag" content="Chat"/><meta property="og:title" content="Problems with PubNub: A Deep Dive into Chat System Challenges"/><meta property="og:description" content="In our client&#x27;s project, we were tasked with developing a comprehensive chat module. The requirements included functionalities such as one-to-one, group, and community chat, where all users could participate without strict limitations on joining specific chat channels."/><meta property="og:image" content="https://tailwind-nextjs-starter-blog.vercel.app/static/images/twitter-card.png"/><meta property="og:image:alt" content="Problems with PubNub: A Deep Dive into Chat System Challenges"/><link rel="canonical" href="https://tailwind-nextjs-starter-blog.vercel.app/blog/problems-with-pubnub"/><meta name="twitter:image" content="https://tailwind-nextjs-starter-blog.vercel.app/static/images/twitter-card.png"/><script type="application/ld+json">{
    "@context": "https://schema.org",
    "@type": "Article",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://tailwind-nextjs-starter-blog.vercel.app/blog/problems-with-pubnub"
    },
    "headline": "Problems with PubNub: A Deep Dive into Chat System Challenges",
    "image": [
      "[object Object]"
     ],
    "datePublished": "2024-02-25T00:00:00.000Z",
    "dateModified": "2024-02-25T00:00:00.000Z",
    "author": {"@type": "Person","name": "Mitul Patel"},
    "publisher": {
      "@type": "Organization",
      "name": "Mitul Patel",
      "logo": {
        "@type": "ImageObject",
        "url": "undefined"
      }
    },
    "description": "In our client's project, we were tasked with developing a comprehensive chat module. The requirements included functionalities such as one-to-one, group, and community chat, where all users could participate without strict limitations on joining specific chat channels."
  }</script><meta name="next-head-count" content="29"/><link rel="preload" href="/_next/static/css/6c6a3735050b53751e2a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6c6a3735050b53751e2a.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/webpack-b5ed9032ecc6e95081c2.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons-5d6bc2389dce70f561fe.js" as="script"/><link rel="preload" href="/_next/static/chunks/433-0ed5a504c088990ae543.js" as="script"/><link rel="preload" href="/_next/static/chunks/778-6b1ba82b6b4b56f5ceb7.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-1013ee5717b68b822025.js" as="script"/><link rel="preload" href="/_next/static/chunks/66-31883a6b8c69c80e053c.js" as="script"/><link rel="preload" href="/_next/static/chunks/162-0bb84504d42957b7c3fb.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-7a150248636da4e154f6.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/blog/%5Bslug%5D-d31ae4d618b075a5bb46.js" as="script"/></head><body class="antialiased text-black bg-white dark:bg-gray-900 dark:text-white"><div id="__next"><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex flex-col justify-between h-screen"><header class="flex items-center justify-between py-10"><div><a aria-label="Tailwind CSS Blog" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="344.564 330.278 111.737 91.218" width="53.87" height="43.61"><defs><linearGradient id="logo_svg__b" gradientUnits="userSpaceOnUse" x1="420.97" y1="331.28" x2="420.97" y2="418.5"><stop offset="0%" stop-color="#06b6d4"></stop><stop offset="100%" stop-color="#67e8f9"></stop></linearGradient><linearGradient id="logo_svg__d" gradientUnits="userSpaceOnUse" x1="377.89" y1="331.28" x2="377.89" y2="418.5"><stop offset="0%" stop-color="#06b6d4"></stop><stop offset="100%" stop-color="#67e8f9"></stop></linearGradient><path d="M453.3 331.28v28.57l-64.66 58.65v-30.08l64.66-57.14z" id="logo_svg__a"></path><path d="M410.23 331.28v28.57l-64.67 58.65v-30.08l64.67-57.14z" id="logo_svg__c"></path></defs><use xlink:href="#logo_svg__a" fill="url(#logo_svg__b)"></use><use xlink:href="#logo_svg__c" fill="url(#logo_svg__d)"></use></svg></div><div class="hidden h-6 text-2xl font-semibold sm:block">Mitul Patel</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/">Blog</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/about">About</a></div><button aria-label="Toggle Dark Mode" type="button" class="w-8 h-8 p-1 ml-1 mr-1 rounded sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="w-8 h-8 ml-1 mr-1 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed w-full h-full top-24 right-0 bg-gray-200 dark:bg-gray-800 opacity-95 z-10 transform ease-in-out duration-300 translate-x-full"><button type="button" aria-label="toggle modal" class="fixed w-full h-full cursor-auto focus:outline-none"></button><nav class="fixed h-full mt-8"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about">About</a></div></nav></div></div></div></header><main class="mb-auto"><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-5xl xl:px-0"><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2024-02-25">Sunday, February 25, 2024</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">Problems with PubNub: A Deep Dive into Chat System Challenges</h1></div></div></header><div class="pb-8 divide-y divide-gray-200 xl:divide-y-0 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:pt-11 xl:border-b xl:border-gray-200 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 xl:block sm:space-x-12 xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><img src="/static/images/mitul.png" alt="avatar" class="w-10 h-10 rounded-full"/><dl class="text-sm font-medium leading-5 whitespace-nowrap"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Mitul Patel</dd><dt class="sr-only">Twitter</dt><dd><a target="_blank" rel="noopener noreferrer" href="https://twitter.com/mitulp236" class="text-blue-500 hover:text-blue-600 dark:hover:text-blue-400">@mitulp236</a></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:pb-0 xl:col-span-3 xl:row-span-2"><div class="pt-10 pb-8 prose dark:prose-dark max-w-none"><div><h2 id="project-requirements"><a href="#project-requirements" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Project Requirements:</h2><p>In our client&#x27;s project, we were tasked with developing a comprehensive chat module. The requirements included functionalities such as one-to-one, group, and community chat, where all users could participate without strict limitations on joining specific chat channels.</p><h2 id="architecture-choices"><a href="#architecture-choices" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Architecture Choices:</h2><p>To meet these requirements, we opted for PubNub as our messaging infrastructure. We structured our system to assign a single PubNub channel for each one-to-one chat. We utilized a single channel for group chats and a separate channel for community discussion groups. Additionally, we implemented PubNub channel groups to simplify subscription management for each user.</p><h2 id="problem-1-adding-channels-to-channel-groups"><a href="#problem-1-adding-channels-to-channel-groups" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Problem 1: Adding Channels to Channel Groups:</h2><p>A significant hurdle we encountered was the limitation on the number of channels that can be added to a PubNub channel group. While the maximum limit is set at 2000 channels (PubNub officials recommended a more conservative 1500), surpassing this limit can lead to unpredictable outcomes. If we exceed the maximum channel limit within a PubNub channel group, the system may not generate an error message despite displaying a successful outcome. However, there&#x27;s a possibility that the operation failed silently, leaving uncertainty about whether the channel was actually added to the group. To ensure accuracy, we must subsequently make an additional call to the PubNub SDK to retrieve a list of registered channels within the channel group. This necessity for a separate verification step adds complexity to the process, highlighting potential shortcomings in the system&#x27;s reliability.</p><h2 id="problem-2-device-token-registration-for-push-notifications"><a href="#problem-2-device-token-registration-for-push-notifications" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Problem 2: Device Token Registration for Push Notifications:</h2><p>PubNub offers built-in push notification services, which initially seemed promising. However, we faced challenges when registering device tokens for users with numerous chat interactions. Essentially, we&#x27;re required to input our cloud messaging credentials and other iOS push notification details into the PubNub dashboard for managing push notifications. Once configured, PubNub handles the delivery of push notifications. To activate push notifications for a specific channel, we must supply the device tokens to the corresponding PubNub channel, enabling notifications for any messages received in that channel.</p><p>However, a significant challenge arises when dealing with users engaged in multiple chat interactions, including one-to-one, group, and other chats. This results in numerous PubNub channels associated with a single user. Consequently, we&#x27;re compelled to register multiple PubNub channels for each token of a user separately. Unfortunately, there&#x27;s no functionality available to simultaneously register multiple channels or a channel group when registering device tokens. Consequently, this leads to excessive backend calls from our system to PubNub servers, impacting system performance and efficiency.</p><h2 id="problem-3-channel-manipulations-in-device-token-flow"><a href="#problem-3-channel-manipulations-in-device-token-flow" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Problem 3: Channel Manipulations in Device Token Flow:</h2><p>Handling registered channels for push notifications turned out to be quite challenging. Imagine we&#x27;ve added 2000 channels to one device token. Now, if we want to stop notifications for some channels or remove them altogether, there&#x27;s a bit of a problem. We can&#x27;t just take channels off the token directly. Instead, we have to fetch from PubNub which channels are on the token, and then we have to make another call to remove the ones we don&#x27;t want. Here&#x27;s the kicker: when we fetch the channels on the token, we only get the first 500. There&#x27;s no way to get the rest. No pagination—just the first 500, plain and simple.</p><h2 id="problem-4-pubnub-api-constraints"><a href="#problem-4-pubnub-api-constraints" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Problem 4: PubNub API Constraints:</h2><p>Another limitation we faced was the payload size restriction of 32KB for PubNub API operations. This constraint posed challenges when sending messages or performing channel manipulations, impacting the scalability of our chat system. Furthermore, encountering errors when making concurrent PubNub calls added complexity and reduced system reliability.</p><h2 id="conclusion"><a href="#conclusion" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Conclusion:</h2><p>While PubNub may suffice for smaller-scale use cases, it falls short when building robust and scalable chat systems. Limitations in channel management, push notification registration, and API constraints hinder the effectiveness of PubNub in complex environments. Improved documentation and logging mechanisms are needed to enhance developer experience and mitigate these challenges. As we navigate these limitations, we explore alternative solutions better suited to meet the demands of our project&#x27;s scale and complexity.</p></div></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300"><a target="_blank" rel="nofollow" href="https://mobile.twitter.com/search?q=https%3A%2F%2Ftailwind-nextjs-starter-blog.vercel.app%2Fblog%2Fproblems-with-pubnub">Discuss on Twitter</a> • <a target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog/blob/master/data/blog/problems-with-pubnub.md">View on GitHub</a></div></div><footer><div class="text-sm font-medium leading-5 divide-gray-200 xl:divide-y dark:divide-gray-700 xl:col-start-1 xl:row-start-2"><div class="py-4 xl:py-8"><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium text-blue-500 uppercase hover:text-blue-600 dark:hover:text-blue-400" href="/tags/tech">Tech</a><a class="mr-3 text-sm font-medium text-blue-500 uppercase hover:text-blue-600 dark:hover:text-blue-400" href="/tags/pub-nub">PubNub</a><a class="mr-3 text-sm font-medium text-blue-500 uppercase hover:text-blue-600 dark:hover:text-blue-400" href="/tags/chat">Chat</a></div></div></div><div class="pt-4 xl:pt-8"><a class="text-blue-500 hover:text-blue-600 dark:hover:text-blue-400" href="/blog">← Back to the blog</a></div></footer></div></div></article></div></main><footer><div class="flex flex-col items-center mt-16"><div class="flex mb-3 space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:mitulp236@gmail.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path><path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/mitulp236"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/channel/UCX-9JA9ydtbLgXgMZdP7ozg"><span class="sr-only">youtube</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M23.499 6.203a3.008 3.008 0 00-2.089-2.089c-1.87-.501-9.4-.501-9.4-.501s-7.509-.01-9.399.501a3.008 3.008 0 00-2.088 2.09A31.258 31.26 0 000 12.01a31.258 31.26 0 00.523 5.785 3.008 3.008 0 002.088 2.089c1.869.502 9.4.502 9.4.502s7.508 0 9.399-.502a3.008 3.008 0 002.089-2.09 31.258 31.26 0 00.5-5.784 31.258 31.26 0 00-.5-5.808zm-13.891 9.4V8.407l6.266 3.604z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/mitulp236"><span class="sr-only">linkedin</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://twitter.com/mitulp236"><span class="sr-only">twitter</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"></path></svg></a></div><div class="flex mb-2 space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Mitul Patel</div><div> • </div><div>© 2024</div><div> • </div><a href="/">Mitul Patel</a></div><div class="mb-8 text-sm text-gray-500 dark:text-gray-400"></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":{"compiledSource":"\"use strict\";\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i \u003c arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i \u003c sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i \u003c sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar layoutProps = {};\nvar MDXLayout = \"wrapper\";\n\nfunction MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h2\", {\n    \"id\": \"project-requirements\"\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#project-requirements\",\n    \"aria-hidden\": \"true\",\n    \"tabIndex\": -1\n  }, mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"icon icon-link\"\n  })), \"Project Requirements:\"), mdx(\"p\", null, \"In our client's project, we were tasked with developing a comprehensive chat module. The requirements included functionalities such as one-to-one, group, and community chat, where all users could participate without strict limitations on joining specific chat channels.\"), mdx(\"h2\", {\n    \"id\": \"architecture-choices\"\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#architecture-choices\",\n    \"aria-hidden\": \"true\",\n    \"tabIndex\": -1\n  }, mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"icon icon-link\"\n  })), \"Architecture Choices:\"), mdx(\"p\", null, \"To meet these requirements, we opted for PubNub as our messaging infrastructure. We structured our system to assign a single PubNub channel for each one-to-one chat. We utilized a single channel for group chats and a separate channel for community discussion groups. Additionally, we implemented PubNub channel groups to simplify subscription management for each user.\"), mdx(\"h2\", {\n    \"id\": \"problem-1-adding-channels-to-channel-groups\"\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#problem-1-adding-channels-to-channel-groups\",\n    \"aria-hidden\": \"true\",\n    \"tabIndex\": -1\n  }, mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"icon icon-link\"\n  })), \"Problem 1: Adding Channels to Channel Groups:\"), mdx(\"p\", null, \"A significant hurdle we encountered was the limitation on the number of channels that can be added to a PubNub channel group. While the maximum limit is set at 2000 channels (PubNub officials recommended a more conservative 1500), surpassing this limit can lead to unpredictable outcomes. If we exceed the maximum channel limit within a PubNub channel group, the system may not generate an error message despite displaying a successful outcome. However, there's a possibility that the operation failed silently, leaving uncertainty about whether the channel was actually added to the group. To ensure accuracy, we must subsequently make an additional call to the PubNub SDK to retrieve a list of registered channels within the channel group. This necessity for a separate verification step adds complexity to the process, highlighting potential shortcomings in the system's reliability.\"), mdx(\"h2\", {\n    \"id\": \"problem-2-device-token-registration-for-push-notifications\"\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#problem-2-device-token-registration-for-push-notifications\",\n    \"aria-hidden\": \"true\",\n    \"tabIndex\": -1\n  }, mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"icon icon-link\"\n  })), \"Problem 2: Device Token Registration for Push Notifications:\"), mdx(\"p\", null, \"PubNub offers built-in push notification services, which initially seemed promising. However, we faced challenges when registering device tokens for users with numerous chat interactions. Essentially, we're required to input our cloud messaging credentials and other iOS push notification details into the PubNub dashboard for managing push notifications. Once configured, PubNub handles the delivery of push notifications. To activate push notifications for a specific channel, we must supply the device tokens to the corresponding PubNub channel, enabling notifications for any messages received in that channel.\"), mdx(\"p\", null, \"However, a significant challenge arises when dealing with users engaged in multiple chat interactions, including one-to-one, group, and other chats. This results in numerous PubNub channels associated with a single user. Consequently, we're compelled to register multiple PubNub channels for each token of a user separately. Unfortunately, there's no functionality available to simultaneously register multiple channels or a channel group when registering device tokens. Consequently, this leads to excessive backend calls from our system to PubNub servers, impacting system performance and efficiency.\"), mdx(\"h2\", {\n    \"id\": \"problem-3-channel-manipulations-in-device-token-flow\"\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#problem-3-channel-manipulations-in-device-token-flow\",\n    \"aria-hidden\": \"true\",\n    \"tabIndex\": -1\n  }, mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"icon icon-link\"\n  })), \"Problem 3: Channel Manipulations in Device Token Flow:\"), mdx(\"p\", null, \"Handling registered channels for push notifications turned out to be quite challenging. Imagine we've added 2000 channels to one device token. Now, if we want to stop notifications for some channels or remove them altogether, there's a bit of a problem. We can't just take channels off the token directly. Instead, we have to fetch from PubNub which channels are on the token, and then we have to make another call to remove the ones we don't want. Here's the kicker: when we fetch the channels on the token, we only get the first 500. There's no way to get the rest. No pagination\\u2014just the first 500, plain and simple.\"), mdx(\"h2\", {\n    \"id\": \"problem-4-pubnub-api-constraints\"\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#problem-4-pubnub-api-constraints\",\n    \"aria-hidden\": \"true\",\n    \"tabIndex\": -1\n  }, mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"icon icon-link\"\n  })), \"Problem 4: PubNub API Constraints:\"), mdx(\"p\", null, \"Another limitation we faced was the payload size restriction of 32KB for PubNub API operations. This constraint posed challenges when sending messages or performing channel manipulations, impacting the scalability of our chat system. Furthermore, encountering errors when making concurrent PubNub calls added complexity and reduced system reliability.\"), mdx(\"h2\", {\n    \"id\": \"conclusion\"\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#conclusion\",\n    \"aria-hidden\": \"true\",\n    \"tabIndex\": -1\n  }, mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"icon icon-link\"\n  })), \"Conclusion:\"), mdx(\"p\", null, \"While PubNub may suffice for smaller-scale use cases, it falls short when building robust and scalable chat systems. Limitations in channel management, push notification registration, and API constraints hinder the effectiveness of PubNub in complex environments. Improved documentation and logging mechanisms are needed to enhance developer experience and mitigate these challenges. As we navigate these limitations, we explore alternative solutions better suited to meet the demands of our project's scale and complexity.\"));\n}\n\n;\nMDXContent.isMDXComponent = true;","renderedOutput":"\u003ch2 id=\"project-requirements\"\u003e\u003ca href=\"#project-requirements\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eProject Requirements:\u003c/h2\u003e\u003cp\u003eIn our client\u0026#x27;s project, we were tasked with developing a comprehensive chat module. The requirements included functionalities such as one-to-one, group, and community chat, where all users could participate without strict limitations on joining specific chat channels.\u003c/p\u003e\u003ch2 id=\"architecture-choices\"\u003e\u003ca href=\"#architecture-choices\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eArchitecture Choices:\u003c/h2\u003e\u003cp\u003eTo meet these requirements, we opted for PubNub as our messaging infrastructure. We structured our system to assign a single PubNub channel for each one-to-one chat. We utilized a single channel for group chats and a separate channel for community discussion groups. Additionally, we implemented PubNub channel groups to simplify subscription management for each user.\u003c/p\u003e\u003ch2 id=\"problem-1-adding-channels-to-channel-groups\"\u003e\u003ca href=\"#problem-1-adding-channels-to-channel-groups\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eProblem 1: Adding Channels to Channel Groups:\u003c/h2\u003e\u003cp\u003eA significant hurdle we encountered was the limitation on the number of channels that can be added to a PubNub channel group. While the maximum limit is set at 2000 channels (PubNub officials recommended a more conservative 1500), surpassing this limit can lead to unpredictable outcomes. If we exceed the maximum channel limit within a PubNub channel group, the system may not generate an error message despite displaying a successful outcome. However, there\u0026#x27;s a possibility that the operation failed silently, leaving uncertainty about whether the channel was actually added to the group. To ensure accuracy, we must subsequently make an additional call to the PubNub SDK to retrieve a list of registered channels within the channel group. This necessity for a separate verification step adds complexity to the process, highlighting potential shortcomings in the system\u0026#x27;s reliability.\u003c/p\u003e\u003ch2 id=\"problem-2-device-token-registration-for-push-notifications\"\u003e\u003ca href=\"#problem-2-device-token-registration-for-push-notifications\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eProblem 2: Device Token Registration for Push Notifications:\u003c/h2\u003e\u003cp\u003ePubNub offers built-in push notification services, which initially seemed promising. However, we faced challenges when registering device tokens for users with numerous chat interactions. Essentially, we\u0026#x27;re required to input our cloud messaging credentials and other iOS push notification details into the PubNub dashboard for managing push notifications. Once configured, PubNub handles the delivery of push notifications. To activate push notifications for a specific channel, we must supply the device tokens to the corresponding PubNub channel, enabling notifications for any messages received in that channel.\u003c/p\u003e\u003cp\u003eHowever, a significant challenge arises when dealing with users engaged in multiple chat interactions, including one-to-one, group, and other chats. This results in numerous PubNub channels associated with a single user. Consequently, we\u0026#x27;re compelled to register multiple PubNub channels for each token of a user separately. Unfortunately, there\u0026#x27;s no functionality available to simultaneously register multiple channels or a channel group when registering device tokens. Consequently, this leads to excessive backend calls from our system to PubNub servers, impacting system performance and efficiency.\u003c/p\u003e\u003ch2 id=\"problem-3-channel-manipulations-in-device-token-flow\"\u003e\u003ca href=\"#problem-3-channel-manipulations-in-device-token-flow\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eProblem 3: Channel Manipulations in Device Token Flow:\u003c/h2\u003e\u003cp\u003eHandling registered channels for push notifications turned out to be quite challenging. Imagine we\u0026#x27;ve added 2000 channels to one device token. Now, if we want to stop notifications for some channels or remove them altogether, there\u0026#x27;s a bit of a problem. We can\u0026#x27;t just take channels off the token directly. Instead, we have to fetch from PubNub which channels are on the token, and then we have to make another call to remove the ones we don\u0026#x27;t want. Here\u0026#x27;s the kicker: when we fetch the channels on the token, we only get the first 500. There\u0026#x27;s no way to get the rest. No pagination—just the first 500, plain and simple.\u003c/p\u003e\u003ch2 id=\"problem-4-pubnub-api-constraints\"\u003e\u003ca href=\"#problem-4-pubnub-api-constraints\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eProblem 4: PubNub API Constraints:\u003c/h2\u003e\u003cp\u003eAnother limitation we faced was the payload size restriction of 32KB for PubNub API operations. This constraint posed challenges when sending messages or performing channel manipulations, impacting the scalability of our chat system. Furthermore, encountering errors when making concurrent PubNub calls added complexity and reduced system reliability.\u003c/p\u003e\u003ch2 id=\"conclusion\"\u003e\u003ca href=\"#conclusion\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eConclusion:\u003c/h2\u003e\u003cp\u003eWhile PubNub may suffice for smaller-scale use cases, it falls short when building robust and scalable chat systems. Limitations in channel management, push notification registration, and API constraints hinder the effectiveness of PubNub in complex environments. Improved documentation and logging mechanisms are needed to enhance developer experience and mitigate these challenges. As we navigate these limitations, we explore alternative solutions better suited to meet the demands of our project\u0026#x27;s scale and complexity.\u003c/p\u003e","scope":{}},"frontMatter":{"wordCount":665,"readingTime":{"text":"4 min read","minutes":3.315,"time":198900,"words":663},"slug":"problems-with-pubnub","fileName":"problems-with-pubnub.md","title":"Problems with PubNub: A Deep Dive into Chat System Challenges","date":"2024-02-25","tags":["Tech","PubNub","Chat"],"draft":false,"summary":"In our client's project, we were tasked with developing a comprehensive chat module. The requirements included functionalities such as one-to-one, group, and community chat, where all users could participate without strict limitations on joining specific chat channels."}},"prev":null,"next":null},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"problems-with-pubnub"},"buildId":"ZEi41qzY6CZDLJz_wjGqQ","isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-8683bd742a84c1edd48c.js"></script><script src="/_next/static/chunks/webpack-b5ed9032ecc6e95081c2.js" async=""></script><script src="/_next/static/chunks/commons-5d6bc2389dce70f561fe.js" async=""></script><script src="/_next/static/chunks/433-0ed5a504c088990ae543.js" async=""></script><script src="/_next/static/chunks/778-6b1ba82b6b4b56f5ceb7.js" async=""></script><script src="/_next/static/chunks/main-1013ee5717b68b822025.js" async=""></script><script src="/_next/static/chunks/66-31883a6b8c69c80e053c.js" async=""></script><script src="/_next/static/chunks/162-0bb84504d42957b7c3fb.js" async=""></script><script src="/_next/static/chunks/pages/_app-7a150248636da4e154f6.js" async=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-d31ae4d618b075a5bb46.js" async=""></script><script src="/_next/static/ZEi41qzY6CZDLJz_wjGqQ/_buildManifest.js" async=""></script><script src="/_next/static/ZEi41qzY6CZDLJz_wjGqQ/_ssgManifest.js" async=""></script></body></html>